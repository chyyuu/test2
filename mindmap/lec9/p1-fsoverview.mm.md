### 第一节 文件和文件系统

- 文件的概念
  - 文件是具有符号名的字节序列构成的数据项集合
  - 文件控制块/文件头部：包含文件属性如名称、类型、位置、创建时间等
- UNIX设计的哲学理念
  - 一切都是文件，提供统一接口，方便应用程序调用
    - 普通文件，目录文件
    - 字符设备文件
    - 块设备文件
    - 网络文件（socket）
- 站在使用者的角度看文件
  - 文件视图
    - 用户的文件视图：持久的数据结构，系统调用接口看作字节序列集合
    - 操作系统的文件视图：数据块的集合
    - 目录是一种特殊的文件，目录下包含文件或子目录
  - 文件中数据的内部结构
    - 与操作系统无关：字节流
    - 与应用相关：无结构文本；简单结构：格式化文件；复杂结构如Word或ELF
  - 文件操作
    - 基本操作：读文件、写文件
      - 进程读文件：获取数据块，返回对应部分
      - 进程写文件：修改数据块中对应部分，写回数据块
    - 其他操作：打开文件、关闭文件、重命名文件、搜索、创建、删除、列目录等
  - 文件的访问模式
    - 顺序访问：按字节依次读取
    - 随机访问：从任意位置读写
    - 索引访问：基于数据特征索引
  - 安全：文件访问控制
    - 访问控制列表 (ACL)
      - 用户对文件的读、写、执行、删除权限
    - UNIX模式：使用者：用户|组|所有人 与 访问权限： 读|写|可执行的组合
  - 共享：多进程如何同时访问共享文件？
    - 文件是共享资源，需要互斥访问，例如使用读写锁
- 站在创造者的角度看文件
  - 进程对文件的管理
    - 文件描述符
      - 文件描述符是指向进程的打开文件描述符表的索引值
      - 应用打开文件后，获得文件描述符--fd，通过fd进行文件读写
      - 应用关闭文件时，释放文件描述符 
    - 打开文件描述符表
      - 用于维护进程打开的所有文件
      - 包含：打开文件的状态和信息，如文件指针、打开计数、文件磁盘位置、访问权限
  - 文件系统对文件的管理
    - 文件系统类型：磁盘文件系统、网络/分布式文件系统、特殊文件系统
    - 虚拟文件系统（VFS）
    - 文件系统功能：管理持久性数据，提供文件命名、存储和检索
      - 分配文件磁盘空间，管理文件集合，数据可靠和安全
      - 文件系统挂载：文件系统需先挂载才能被访问
    - 文件系统组织形式：分层文件系统，目录是特殊文件，包含文件索引表
      - 目录
        - 目录操作：搜索、创建、删除、列目录、重命名文件
        - 目录实现：文件名线性列表或哈希表
      - 文件别名：硬链接和软链接
        - 硬链接：多个文件项指向一个文件
        - 软链接：新建文件存储文件名称指向其他文件


