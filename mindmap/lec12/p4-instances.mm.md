### 第四节 同步互斥实例问题
- 哲学家就餐问题
  - 描述
    - 5个哲学家围绕一张圆桌而坐
    - 桌子上放着5支叉子
    - 每两个哲学家之间放一支叉子
    - 哲学家的动作包括思考和进餐
    - 进餐时需同时用左右两边的叉子
    - 思考时将两支叉子放回原处
  - 方案分析
    - 方案1
      - 可能导致死锁
    - 方案2
      - 正确但每次只允许一人进餐
    - 方案3
      - 没有死锁，可有多人同时就餐，通用性弱
    - 方案4
      - 使用AND型信号量解决方案
        - AND型信号量集是指同时需要多个资源且每种占用一个资源时的信号量操作。
        - AND型信号量集基本思路：在一个原语中申请整段代码需要的多个临界资源，要么全部分配给它，要么一个都不分配给它。
    - 方案5
      - 高效并行方案，避免死锁
      - 使用一个数组state跟踪每一个哲学家是在进餐、思考还是饥饿状态（正在试图拿叉子）
      - 一个哲学家只有在两个邻居都没有进餐时才允许进入到进餐状态
- 读者-写者问题
  - 问题描述
    - 共享数据的两类使用者：读者和写者
    - 读者：只读不修改数据
    - 写者：读取和修改数据
    - 读者之间允许并发读
    - 写者之间需互斥
    - 读者和写者之间也需互斥
  - 解决策略
    - 读者优先策略
      - 读者持续不断进入可能导致写者饥饿
    - 写者优先策略
      - 如写者持续不断就绪，则读者就处于饥饿
  - 信号量实现
    - 使用信号量控制读写操作的互斥和同步
      - 信号量WriteMutex：控制读写操作的互斥，初始化为1
      - 读者计数Rcount ：正在进行读操作的读者数目，初始化为0
      - 信号量CountMutex：控制对读者计数的互斥修改，初始化为1
  - 管程实现
    - 使用管程提供更结构化和安全的同步机制
    - 管程中的状态变量设计
    - 管程中的锁和条件变量设计

