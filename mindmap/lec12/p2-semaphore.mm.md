### 第二节 信号量
- 信号量 (semaphore)
  - 概念
    - 操作系统提供的协调共享资源访问的方法
    - 由Dijkstra在20世纪60年代提出
    - 早期操作系统的主要同步机制
    - 用于**互斥访问**和**条件同步**
  - 结构
    - 整型变量 (sem)
    - 两个原子操作
      - P()：减少操作
        - sem = sem - 1
        - 如果 sem<0, 进入等待, 否则继续
      - V()：增加操作
        - sem = sem + 1
        - 如果 sem <= 0, 唤醒一个等待的线程
  - 特性
    - 被保护的整数变量
    - 只能通过P()和V()操作修改
    - P/V操作是原子操作，由操作系统保证
    - P()可能阻塞，V()不会阻塞
    - 通常假定信号量是“公平的”
  - 分类
    - 二进制信号量: 资源数目为0或1
    - 计数信号量: 资源数目为任何非负值
  - 使用示例
    - 一般使用方式
      - 互斥访问: 使用信号量来保证临界区的互斥访问
      - 条件同步: 使用信号量同步特定条件下的行为
    - 生产者-消费者问题
      - 描述: 生产者生成数据放入缓冲区，消费者从缓冲区取数据
      - 约束条件
        - 互斥访问: 缓冲区同时只能被一个生产者或消费者访问
        - 条件同步：缓冲区空时消费者等待
        - 条件同步：缓冲区满时生产者等待
      - 用信号量解决方案
        - 二进制信号量 mutex 控制缓冲区访问
        - 计数信号量 fullBuffers 和 emptyBuffers 控制缓冲状态
      - 代码实现难度
        - 代码编写和理解上的复杂性
        - 容易出错，如忘记释放信号量、死锁问题




